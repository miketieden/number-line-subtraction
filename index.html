<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Number Line Subtraction</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Lexend:wght@400;600;800&display=swap');
        
        body {
            font-family: 'Lexend', sans-serif;
            background-color: #f0f9ff;
            touch-action: manipulation;
            overflow: hidden; /* Prevent body scroll */
        }

        .number-line-container {
            position: relative;
            padding-top: 130px; /* Reduced from 160px */
            padding-bottom: 40px; /* Reduced from 60px */
        }

        .number-line {
            height: 6px;
            background: #334155;
            position: relative;
            border-radius: 3px;
        }

        #jumps-container {
            position: absolute;
            left: 0;
            right: 0;
            bottom: 100%;
            height: 0;
        }

        .jump-big {
            position: absolute;
            border: 4px solid #f59e0b;
            border-bottom: none;
            border-radius: 50% 50% 0 0;
            pointer-events: none;
            animation: bounceIn 0.5s ease-out;
            transform-origin: bottom;
        }

        .jump-small {
            position: absolute;
            border: 3px solid #3b82f6;
            border-bottom: none;
            border-radius: 50% 50% 0 0;
            pointer-events: none;
            animation: bounceIn 0.3s ease-out;
            transform-origin: bottom;
        }

        @keyframes bounceIn {
            0% { transform: scaleY(0); opacity: 0; }
            70% { transform: scaleY(1.1); }
            100% { transform: scaleY(1); opacity: 1; }
        }

        .label-container {
            position: absolute;
            top: 15px; 
            transform: translateX(-50%);
            text-align: center;
            display: flex;
            flex-direction: column-reverse;
        }

        .label-input {
            width: 60px; /* Slightly narrower */
            text-align: center;
            border: 3px solid #cbd5e1;
            border-radius: 10px;
            padding: 4px;
            font-weight: 800;
            font-size: 1rem;
            transition: all 0.2s;
        }

        .label-input:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .label-input.correct {
            border-color: #22c55e;
            background-color: #f0fdf4;
            color: #15803d;
        }

        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        /* Modal Styles */
        #rules-modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            z-index: 50;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
    </style>
</head>
<body class="p-2 md:p-4 h-screen flex items-center justify-center">
    <div class="max-w-4xl w-full bg-white rounded-3xl shadow-xl p-4 md:p-6 border-4 border-blue-50">
        
        <!-- Top Bar -->
        <div class="flex justify-between items-center mb-4">
            <button onclick="toggleRules(true)" class="bg-blue-100 text-blue-700 px-3 py-1.5 rounded-lg font-bold hover:bg-blue-200 transition-colors text-sm">
                How to Play?
            </button>
            <h1 class="text-2xl font-extrabold text-blue-600">Number Line Subtraction</h1>
            <div class="w-24"></div> 
        </div>

        <!-- Problem Header -->
        <div class="text-center mb-4">
            <p id="problem-text" class="text-xl text-slate-700 font-bold bg-blue-50 py-2 px-4 rounded-xl inline-block">Loading problem...</p>
        </div>

        <!-- Game Area -->
        <div class="relative bg-slate-50 rounded-2xl p-2 md:p-6 mb-4 min-h-[300px] overflow-hidden border-2 border-slate-100">
            <div class="number-line-container">
                <div class="number-line" id="line">
                    <div id="jumps-container"></div>
                </div>

                <!-- Start Label -->
                <div class="label-container" style="left: 10%;">
                    <input type="number" id="start-label" class="label-input" placeholder="?">
                    <p class="text-xs font-bold text-slate-500 mb-1 uppercase tracking-wider">Start</p>
                </div>

                <!-- End Label -->
                <div class="label-container" style="left: 90%;">
                    <input type="number" id="end-label" class="label-input" placeholder="?">
                    <p class="text-xs font-bold text-slate-500 mb-1 uppercase tracking-wider">Target</p>
                </div>
            </div>
        </div>

        <!-- Controls -->
        <div class="flex flex-wrap gap-4 justify-center items-center">
            <div id="action-controls" class="flex gap-3">
                <button onclick="addJump(10)" class="bg-amber-500 hover:bg-amber-600 text-white px-6 py-2 rounded-xl font-black shadow-md hover:shadow-lg transition-all active:scale-95 flex flex-col items-center">
                    <span class="text-xl">Jump +10</span>
                    <span class="text-[10px] uppercase opacity-90">Big Bump</span>
                </button>
                <button onclick="addJump(1)" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-xl font-black shadow-md hover:shadow-lg transition-all active:scale-95 flex flex-col items-center">
                    <span class="text-xl">Jump +1</span>
                    <span class="text-[10px] uppercase opacity-90">Small Bump</span>
                </button>
            </div>
            
            <button onclick="clearJumps()" class="bg-slate-200 hover:bg-slate-300 text-slate-700 px-4 py-2 rounded-xl font-bold transition-colors text-sm">
                Reset Jumps
            </button>
        </div>

        <!-- Result Section -->
        <div id="final-step" class="mt-4 text-center">
            <div class="flex justify-center items-center gap-4">
                <p class="text-lg font-black text-slate-800">Total distance jumped:</p>
                <input type="number" id="final-answer" class="w-24 text-center text-2xl font-black border-4 border-blue-400 rounded-xl p-1 focus:ring-4 ring-blue-100 outline-none" placeholder="??">
                <button onclick="checkAnswer()" class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-xl font-black shadow-md text-lg transition-transform active:scale-95">Check!</button>
            </div>
        </div>

        <!-- Success Message -->
        <div id="success-message" class="hidden mt-4 p-4 bg-green-50 border-4 border-green-200 text-green-800 rounded-2xl text-center shadow-inner">
            <h2 class="text-2xl font-black mb-1">WOW! ðŸŽ‰</h2>
            <button onclick="initGame()" class="bg-green-600 hover:bg-green-700 text-white px-8 py-2 rounded-xl font-black text-lg shadow-md transition-all active:scale-95">Next Problem</button>
        </div>
    </div>

    <!-- Rules Modal -->
    <div id="rules-modal">
        <div class="bg-white p-6 rounded-3xl max-w-lg w-full shadow-2xl">
            <h3 class="text-2xl font-black text-blue-600 mb-3">Rules of the Game</h3>
            <ul class="text-base text-slate-700 space-y-2 mb-6">
                <li>1. Label the <strong>Start</strong> and <strong>Target</strong> boxes based on the question.</li>
                <li>2. Add <strong>Big Bumps</strong> to jump by 10.</li>
                <li>3. Add <strong>Small Bumps</strong> to jump by 1.</li>
                <li>4. Count all your bumps to find the total distance!</li>
            </ul>
            <button onclick="toggleRules(false)" class="w-full bg-blue-600 text-white py-3 rounded-xl font-black text-lg hover:bg-blue-700">Got it!</button>
        </div>
    </div>

    <script>
        let currentProblem = { start: 0, end: 0, diff: 0 };
        let currentPosition = 0;
        let jumps = [];

        const names = ["Jon", "Bill", "Sarah", "Kim", "Alex", "Sam", "Leo", "Mia", "Ben", "Ava"];
        
        function initGame() {
            currentPosition = 0;
            jumps = [];
            
            document.getElementById('jumps-container').innerHTML = '';
            document.getElementById('start-label').value = '';
            document.getElementById('end-label').value = '';
            document.getElementById('start-label').classList.remove('correct');
            document.getElementById('end-label').classList.remove('correct');
            document.getElementById('final-answer').value = '';
            document.getElementById('final-step').classList.remove('hidden');
            document.getElementById('success-message').classList.add('hidden');

            const n1 = Math.floor(Math.random() * 30) + 5;
            const n2 = n1 + (Math.floor(Math.random() * 60) + 15);
            currentProblem = { start: n1, end: n2, diff: n2 - n1 };

            const name1 = names[Math.floor(Math.random() * names.length)];
            let name2 = names[Math.floor(Math.random() * names.length)];
            while(name1 === name2) name2 = names[Math.floor(Math.random() * names.length)];

            document.getElementById('problem-text').innerText = `${name1} is ${n1}, ${name2} is ${n2}. How much older is ${name2}?`;

            currentPosition = n1;
        }

        function toggleRules(show) {
            document.getElementById('rules-modal').style.display = show ? 'flex' : 'none';
        }

        function checkLabels() {
            const s = parseInt(document.getElementById('start-label').value);
            const e = parseInt(document.getElementById('end-label').value);

            if (s === currentProblem.start) {
                document.getElementById('start-label').classList.add('correct');
            } else {
                document.getElementById('start-label').classList.remove('correct');
            }
            
            if (e === currentProblem.end) {
                document.getElementById('end-label').classList.add('correct');
            } else {
                document.getElementById('end-label').classList.remove('correct');
            }
        }

        document.getElementById('start-label').addEventListener('input', checkLabels);
        document.getElementById('end-label').addEventListener('input', checkLabels);

        function addJump(value) {
            const startX = getPercentPos(currentPosition);
            currentPosition += value;
            const endX = getPercentPos(currentPosition);
            
            jumps.push(value);
            renderJump(startX, endX, value);
        }

        function getPercentPos(val) {
            const range = currentProblem.end - currentProblem.start;
            const progress = (val - currentProblem.start) / range;
            return 10 + (progress * 80);
        }

        function renderJump(x1, x2, val) {
            const container = document.getElementById('jumps-container');
            const jump = document.createElement('div');
            const width = Math.max(x2 - x1, 2); 
            const height = val === 10 ? 80 : 40; /* Reduced heights */
            
            jump.className = val === 10 ? 'jump-big' : 'jump-small';
            jump.style.left = `${x1}%`;
            jump.style.width = `${width}%`;
            jump.style.height = `${height}px`;
            jump.style.bottom = `0px`; 

            container.appendChild(jump);
        }

        function clearJumps() {
            currentPosition = currentProblem.start;
            jumps = [];
            document.getElementById('jumps-container').innerHTML = '';
        }

        function checkAnswer() {
            const ans = parseInt(document.getElementById('final-answer').value);
            const s = parseInt(document.getElementById('start-label').value);
            const e = parseInt(document.getElementById('end-label').value);

            if (s !== currentProblem.start || e !== currentProblem.end) {
                return; // Quietly fail if labels aren't set
            }

            if (ans === currentProblem.diff) {
                document.getElementById('success-message').classList.remove('hidden');
                document.getElementById('final-step').classList.add('hidden');
            } else {
                const input = document.getElementById('final-answer');
                input.classList.add('border-red-500', 'bg-red-50');
                setTimeout(() => {
                    input.classList.remove('border-red-500', 'bg-red-50');
                }, 1000);
            }
        }

        window.onload = initGame;
    </script>
</body>
</html>
